
## 信号量



    信号量：信号量是一个计数器，可以用来控制多个进程对共享资源的访问。信号
    量只有等待和发送两种操作。等待(P(sv))就是将其值减一或者挂起进程，发送
    (V(sv))就是将其值加一或者将进程恢复运行。
    信号量提供了保护机制，它使得共享的资源，在任一时刻只能被一个进程访问，
    防止多进程竞争共享资源，而造成的数据错乱。
1. 信号量的原理

  信号量其实是一个整型的计数器，主要就用于实现进程间的互斥与同步，而不是用于缓存进程间通信的数据。信号量表示的是资源的数量，我们有两种原子操作进行控制信号量：P操作 和 V操作。P操作是用在进入共享资源之前，V操作是用在离开共享资源之后，两个操作必须成对出现。
2. 信号量操做

+ P操作：会把信号量减去1，相减后如果信号量 <0，则表明资源已经被占用，进程需要阻塞等待；相减后如果信号量>=0，则表明还有资源可以使用，进程可以正常继续执行。
+ V操作：会把信号量加上1，相加后如果信号量 <=0，则表明当前有阻塞中的进程，于是会将该进程唤醒运行；相加后如果信号量 >0，则表明当前没有阻塞中的进程；

    注：最简单的例子就是生产者消费者模型。
3. 初始化信号量

+ 初始化为1：代表互斥信号量。举个例子，A、B进程都要访问共享内存且信号量都初始化为1，进程A在访问共享内存前，先执⾏了P操作，因为信号量的初始值为1，所以进程A执⾏P操作后信号量变为0，表示共享资源可⽤，所以它就可以访问共享内存了。 如果这个时候，B也想访问共享内存，它执行了P操作，结果信号量变成了-1，就代表这个资源已经被占用了，所以它就被阻塞了。直到进程A访问完共享内存，才会去执行V操作，让信号量恢复为0，接着就会唤醒进程B，B就可以去访问共享内存了，最后访问完，执行V操作，把信号量恢复成初始值1。
+ 初始化为0：代表同步信号量。这个也举个例子，还是A、B进程，A进程负责生产数据，B进程负责读取数据，A必须生产了数据，B才能读取到数据，我们把初始值都设为0，如果进程B比进程A先执行了，那么执行到P操作时，因为信号量初始值为0，所以信号量会变成-1，表示A还没生产数据呢，于是B就阻塞等待了。然后当A生产完数据后，执行了V操作，就会使得信号量变为0，于是就会唤醒阻塞在P操作的B。最后B被唤醒了，也就代表A已经生产了数据，于是B就可以正常读取数据了。
