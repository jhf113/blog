# TCP滑动窗口
**TCP滑动窗口协议？**
滑动窗口协议属于TCP协议的一种应用，用于网络数据传输时的流量控制，以避免拥塞的发生。TCP滑动窗口通过动态改变窗口大小来调节两台主机间的数据传输。每个TCP/IP主机支持全双工数据传输，所以TCP有两个滑动窗口：一个用于接收数据，另一个用于发送数据。TCP使用的是肯定确认技术，确认号指的是下一个所期待的字节。加入发送方每次发送三个数据包，也就是说这个窗口大小是3。发送方的发送序列号就是1，2，3，接收方如果成功接收了，就返回序列号4。发送方收到确认，继续以窗口大小为3发送数据。这就是滑动窗口的实现机制。滑动窗口协议可以提高数据的传输效率，提高网络吞吐量。
**滑动窗口可以动态调节大小**
当接收方要求降低或者增大网络流量时，可以对窗口大小进行减少或增加，假如我们降低窗口大小为2，就是每一次发送两个数据包。当接收方要求窗口大小为0时，表示接收方已经接受了全部数据，或者接收方应用程序没有时间读取数据，要求暂停发送。发送方接收到携带窗口号为0的确认，停止数据传输。
**确定滑动窗口大小**
滑动窗口的大小并不是固定的，第一次发送数据的窗口大小是根据链路的带宽大小来确定的。之所以使用滑动窗口，主要是为了避免不必要的数据阻塞链路。假如窗口是固定大小的，会出现窗口过小或过大的情况。
**窗口过小**
当传输比较大的数据的时候需要不停的对数据进行确认，这个时候就会造成很大的延迟。
**窗口过大**
假设发送方一次发送100个数据。但是接收方只能处理50个数据。这样每次都会只对这50个数据进行确认。发送方下一次还是发送100个数据，但是接受方还是只能处理50个数据。
**滑动窗口协议**
滑动窗口协议属于TCP协议的一种应用，用于网络数据传输时的流量控制，以避免拥塞的发生。它允许发送方在停止并等待确认前发送多个数据分组。因为发送方不必每发一个分组就停下来等待确认，所以滑动窗口协议可以提高数据的传输效率，提高网络吞吐量。滑动窗口本质上是描述接收方的TCP数据报缓冲区大小的数据，发送方会根据这个数据来计算自己最多能发送多少的数据，如果发送方收到接受方的窗口大小为0的TCP数据报，那么发送方将停止发送数据，等到接受方发送窗口大小不为0的数据报的到来。
**滑动窗口具体流程**
![Alt text](https://wx1.sinaimg.cn/mw2000/008sKdQply1h2naoc2t2cj30mn0bxwhd.jpg)
我们假设这个时候窗口的大小是3。这个时候接受方收到数据以后会对数据进行确认告诉发送方我下次希望手到的是数据是多少。这里我们看到接收方发送的ACK=3(这是发送方发送序列2的回答确认，下一次接收方期望接收到的是3序列信号)。这个时候发送方收到这个数据以后就知道我第一次发送的3个数据对方只收到了2个。就知道第3个数据对方没有收到。下次在发送的时候就从第3个数据开始发。
![ALt text](https://wx1.sinaimg.cn/mw2000/008sKdQply1h2nanvkiuzj30n10argp1.jpg)
这个时候发送方发送2个数据。
![Alt text](https://wx4.sinaimg.cn/mw2000/008sKdQply1h2nanxapj2j30mx0azwie.jpg)送的ACK是5就表示他下一次希望收到的数据是5，发送方就知道我刚才发送的2个数据对方收了这个时候开始发送第5个数据。
这就是滑动窗口的工作机制，当链路变好了或者变差了这个窗口还会发生变话，并不是第一次协商好了以后就永远不变了。
