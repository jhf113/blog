## 红黑树简介

红黑树是一棵自平衡的二叉查找树，它不但拥有二叉查找树的特性，还有一些自己的特性，

1. 结点是红色或黑色。

2. 根结点是黑色。

3. 每个叶子结点都是黑色的空结点（NIL结点）。

4. 每个红色结点的两个子结点都是黑色。(从每个叶子到根的所有路径上不能有两个连续的红色结点)

5. 从任一结点到其每个叶子的所有路径都包含相同数目的黑色结点。

有了这5个性质作为限制，就可以避免二叉查找树退化成单链表的情况。性质4和5的约束保证了任意节点到其每个叶子节点路径最长不会超过最短路径的2倍。原因是：当某条路径最短时，这条路径一定都是由黑色节点构成的；当某条路径长度最长时，这条路径一定是有红色和黑色节点相间构成的，（性质4限制了不能出现两个连续的红色节点）而性质5又限制了从任意节点到其每个叶子结点的所有路径必须包含相同数量的黑色节点，此时，在路径最长的情况下，路径上红色节点数量 = 黑色节点数量。该路径长度为两倍黑色节点数量，也就是最短路径长度的2倍。
##红黑树为什么可以做到自平衡？
主要是它具有三种操作，左旋、右旋、变色。通过这三种情况就可以达到自平衡了。

左旋：逆时针旋转红黑树的两个结点，使得父结点被自己的右孩子取代，而自己成为自己的左孩子。

右旋：顺时针旋转红黑树的两个结点，使得父结点被自己的左孩子取代，而自己成为自己的右孩子。

变色：为了重新复核红黑树的规则，尝试把红色节点变为黑色，或者把黑色节点边为红色。
##红黑树的删除操作
红黑树的删除操作比插入操作更复杂。删除操作首先要确定待删除节点有几个孩子，如果有两个孩子，不能直接删除该节点。而是要先找到该节点的前驱（该节点左子树中最大的节点）或者后继（该节点右子树中最小的节点），然后将前驱或者后继的值复制到要删除的节点中，最后再将前驱或后继删除。由于前驱和后继至多只有一个孩子节点，这样我们就把原来要删除的节点有两个孩子的问题转化为只有一个孩子节点的问题，问题被简化了一些。我们并不关心最终被删除的节点是否是我们开始想要删除的那个节点，只要节点里的值最终被删除就行了，至于树结构如何变化，这个并不重要。

红黑树删除操作的复杂度在于删除节点的颜色，当删除的节点是红色时，直接拿其孩子节点补空位即可。因为删除红色节点，性质5（从任一节点到其每个叶子的所有简单路径都包含相同数目的黑色节点）仍能够被满足。当删除的节点是黑色时，那么所有经过该节点的路径上的黑节点数量少了一个，破坏了性质5。如果该节点的孩子为红色，直接拿孩子节点替换被删除的节点，并将孩子节点染成黑色，即可恢复性质5。但如果孩子节点为黑色，处理起来就要复杂的多。

在展开说明之前，我们先做一些假设，方便说明。这里假设最终被删除的节点为X（至多只有一个孩子节点），其孩子节点为N，X的兄弟节点为S，S的左节点为 SL，右节点为 SR。接下来讨论是建立在节点 X 被删除，节点 N 替换X的基础上进行的。这里说明把被删除的节点X特地拎出来说一下的原因是防止大家误以为节点N会被删除，不然后面就会看不明白。
红黑树删除操作大致可以分为6种情况
`https://segmentfault.com/a/1190000012728513`
##红黑树的插入操作
它的插入操作和二叉查找树类似，不过它需要在插入新节点后重新调整，满足红黑树的性质。我们插入节点的颜色应该是红色，因为从性质5可以看出，如果我们插入的是黑色节点，那么这个节点所在路径就比其他路径多出一个黑色节点，这样调整穷了会比较麻烦，所以我们需要插入红色节点，这样所有路径上的黑色节点数量不变，尽可能出现两个连续的红色节点的情况，在这种情况下，我们仅需通过变色和旋转进行调整即可。

红黑树插入操作大致可以分为5种情况。

	1) 空树，新节点位于树根，没有父节点。
	直接让新节点变色为黑色，性质2得到满足，同时褐色的根节点使得每条路径上
	的黑色节点数目都增加了1，所以没有打破性质5。



![Alt text](https://wx3.sinaimg.cn/mw2000/008dSTNkly1h1tabiv4c3j305s02xmxb.jpg)

	
	2) 新节点的父节点是黑色的。
	新插入的红色节点并没有打破红黑树的性质，所以不需要调整。
![Alt text](https://wx2.sinaimg.cn/mw2000/008dSTNkly1h1tabkzs5bj308009qgmc.jpg)
	
	3) 新节点的父节点和叔叔节点都是红色的。
	因为两个节点是连续的红色节点，违反了性质4，所以我们先让父节点变为黑色，
	然后让根节点变为红的，这样根节点和叔叔节点又是连续红色了，
	所以我们让叔叔节点变为黑色。这样就符合了红黑树的性质。

![Alt text](https://wx2.sinaimg.cn/mw2000/008dSTNkly1h1tac2yo5xj30gz04f765.jpg)
	
	4) 新节点的父节点是红色，叔叔节点是黑色或者没有叔叔节点，
	而且新节点是父节点的右孩子，父节点是祖父节点的左孩子。
	我们以节点B为轴，做一次左旋转，使得新节点D成为父节点，
	原来的父节点B成为D的左孩子。这样就到了第5中情况。
![Alt text](https://wx2.sinaimg.cn/mw2000/008dSTNkly1h1tac7i6orj30o60cegqa.jpg)
	
	5) 新节点的父节点是红色，叔叔节点是黑色或者没有叔叔节点，
	而且新节点是父节点的左孩子，父节点是祖父节点的左孩子。
	以根节点A为轴，做一次右旋转，使得节点B成为根节点，节点A成为节点B的右孩子。
	然后让节点B变为黑色，节点A变为红色。这样就符合了红黑树的性质。

![Alt text](https://wx4.sinaimg.cn/mw2000/008dSTNkly1h1tach89pvj30am03wwfb.jpg)
